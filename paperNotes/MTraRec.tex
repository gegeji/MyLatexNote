\begin{equation}\begin{aligned} {z}_{i} &=\sigma\left(\mathbf{W}_{{z}} \cdot\left[{s}_{i-1}, {~g}_{i}\right]+\mathbf{b}_{{z}}\right) \\ \mathfrak{R}_{i} &=\sigma\left(\mathbf{W}_{\mathfrak{R}} \cdot\left[\mathbf{s}_{i-1}, \mathbf{g}_{i}\right]+{b}_{\mathfrak{R}}\right) \\ \tilde{\mathbf{s}}_{i} &=\tanh \left(\mathbf{W}_{\mathbf{s}} \cdot\left[\mathfrak{R}_{i} * \mathbf{s}_{i-1}, \mathbf{g}_{i}\right]+\mathbf{b}_{{s}}\right) \\ s_{i} &=\left(1-{z}_{i}\right) * {~s}_{i-1}+{z}_{i} * \tilde{{s}}_{i} \end{aligned}\end{equation}

\begin{equation} {s}_{i}=\operatorname{GRU}\left({s}_{i-1}, {~g}_{i-1}\right) \end{equation}

\begin{equation} \mathbf{h}_{j}=G R U\left(\mathbf{h}_{j-1}, e_{j-1}, r_{j-1}\right) \end{equation}

\begin{equation} f(d)=e^{-\frac{d^{2}}{\beta^{2}}} \end{equation}

\begin{equation}
\mathbf{c}_{j, \ell}= \begin{cases}f\left(d_{j, \ell}\right), & \text { if } j \in\left\{g_{i} . t i d \mid i \in[1, n]\right\} \text { and } d_{j, \ell}<50 \\ 0, & \text { if } j \in\left\{g_{i} . t i d \mid i \in[1, n]\right\} \text { and } d_{i, \ell} \geq 50 \\ 1, & \text { otherwise }\end{cases}
\end{equation}

\begin{equation}
P\left(\hat{e}_{j} \mid \mathbf{h}_{j}\right)=\frac{\exp \left(\mathbf{h}_{j}^{\top} \cdot \mathbf{w}_{c}\right) \odot \mathbf{c}_{j}}{\sum_{c \boldsymbol{r} \in C} \exp \left(\mathbf{h}_{j}^{\top} \cdot \mathbf{w}_{c^{\prime}}\right) \odot \mathbf{c}_{j}}
\end{equation}

\begin{equation}\hat{e}_j = \arg \max_{e_j} P\left({e}_{j} \mid \mathbf{h}_{j}\right)\end{equation}

\begin{equation} \mathbf{h}_{j}=G R U\left(\mathbf{h}_{j-1}, e_{j-1}, r_{j-1}, \mathbf{a}_{j}\right) \end{equation}

\begin{equation}
\mathbf{a}_{j}=\sum_{i=1}^{n} \alpha_{j, i} {~s}_{i}
\end{equation}

\begin{equation}
\alpha_{j, i}=\frac{\exp \left(u_{j, i}\right)}{\sum_{i^{\prime}=1}^{n} \exp \left(u_{j, i^{\prime}}\right)}
\end{equation}

\begin{equation}
u_{j, i}=\mathbf{v}^{\top} \cdot \tanh \left(\mathbf{W}_{\mathbf{h}} \mathbf{h}_{j}+\mathbf{W}_{s} \mathbf{s}_{i}\right)
\end{equation}

损失函数

\begin{equation}
\begin{gathered}
\mathcal{L}_{1}(\theta)=-\sum_{(\tau, \tilde{\tau}) \in \mathcal{D}_{\text {sub }}} \sum_{j=1}^{|\tilde{\tau}|} \sum_{\ell=1}^{L} 1\left\{a_{j} \cdot e=e_{\ell}\right\} \log \left(P_{\theta}\left(\hat{a}_{j} . e=e_{\ell} \mid \mathbf{d}_{1: j-1}\right)\right) \\
\text { s.t. } \mathbf{d}_{j-1}=\left(\tau, \tilde{\tau}_{1: j-1}, {f}_{{s} j-1}, {f}_{{e}}\right)
\end{gathered}
\end{equation}

\begin{equation}
\begin{aligned}
\mathcal{L}_{2}(\theta)=-\sum_{\left(\tau^{\prime}, \tilde{\tau}\right) \in \mathcal{D}_{\text {sub }}} \sum_{j=1}^{|\tilde{\tau}|}\left(a_{j} \cdot r-R_{\theta}\left(\mathbf{d}_{j-1}\right)\right)^{2} \\
\text { s.t. } \mathbf{d}_{j-1}=\left(\tau^{\prime}, \tilde{\tau}_{1: j-1}, \mathbf{f}_{{s} j-1}, \mathbf{f}_{{e}}\right),
\end{aligned}
\end{equation}

\begin{equation}\mathcal{L}_t = \mathcal{L}_1(\theta) + \lambda \mathcal{L}_2(\theta)\end{equation}

$\mathbf{h}_{0}=FCN(\mathbf{s} _n, Emb(\mathbf{f_e} ))$

\begin{equation} M A E=\frac{1}{m} \sum_{j=1}^{m}\left|d i s\left(a_{j}, \hat{a}_{j}\right)\right| \end{equation}

$ R M S E=\sqrt{\frac{1}{m} \sum_{j=1}^{m}\left(\operatorname{dis}\left(a_{j}, \hat{a}_{j}\right)\right)^{2}} $
s.t. $ \operatorname{dis}\left(a_{j}, \hat{a}_{j}\right)=\min \left(r n_{-} d i s\left(a_{j}, \hat{a}_{j}\right), r n_{-} \operatorname{dis}\left(\hat{a}_{j}, a_{j}\right)\right) $

recall $ =\frac{\left|\mathcal{E}_{R} \cap \mathcal{E}_{G}\right|}{\left|\mathcal{E}_{G}\right|} $

precision $ =\frac{\left|\mathcal{E}_{R} \cap \mathcal{E}_{G}\right|}{\left|\mathcal{E}_{R}\right|} $